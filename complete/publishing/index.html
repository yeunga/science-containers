
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation and Science Containers for the CANFAR Science Platform">
      
      
        <meta name="author" content="CANFAR">
      
      
        <link rel="canonical" href="https://opencadc.github.io/science-containers/complete/publishing/">
      
      
        <link rel="prev" href="../../general/NewUser/LaunchNotebook/">
      
      
        <link rel="next" href="../permissions/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.4.6">
    
    
      
        <title>Publishing Containers - CANFAR Science Platform</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.35e1ed30.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.356b1318.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#canfar-science-platform-containers" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="CANFAR Science Platform" class="md-header__button md-logo" aria-label="CANFAR Science Platform" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CANFAR Science Platform
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Publishing Containers
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
</form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/opencadc/science-containers/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    opencadc/science-containers
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="CANFAR Science Platform" class="md-nav__button md-logo" aria-label="CANFAR Science Platform" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CANFAR Science Platform
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/opencadc/science-containers/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
  </div>
  <div class="md-source__repository">
    opencadc/science-containers
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Introduction and Access
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Introduction and Access
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Official CANFAR Science Platform Documentation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    General User Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            General User Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Welcome to the documentation for CANFAR's Science Portal!
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    New User Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            New User Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/NewUser/Overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Portal Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/NewUser/Login/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Login
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/NewUser/ProjectSpace/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Space
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/NewUser/LaunchDesktop/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launch Desktop
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/NewUser/LaunchCARTA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launch CARTA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/NewUser/LaunchNotebook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Launch Notebook
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    In-Depth Documentation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            In-Depth Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Publishing Containers
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Publishing Containers
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-canfar-science-platform-containers" class="md-nav__link">
    Building CANFAR Science Platform Containers
  </a>
  
    <nav class="md-nav" aria-label="Building CANFAR Science Platform Containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimum-requirements" class="md-nav__link">
    Minimum requirements
  </a>
  
    <nav class="md-nav" aria-label="Minimum requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sssd-and-acl" class="md-nav__link">
    SSSD and ACL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-requirements-for-legacy-desktop-application-containers" class="md-nav__link">
    Additional requirements for legacy desktop application containers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialization-and-startup" class="md-nav__link">
    Initialization and Startup
  </a>
  
    <nav class="md-nav" aria-label="Initialization and Startup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-container-process-owners" class="md-nav__link">
    Running container process owners
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-container-initialization" class="md-nav__link">
    Session container initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributed-session-containers" class="md-nav__link">
    Contributed session containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-container-initialization" class="md-nav__link">
    Software container initialization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-skaha-containers" class="md-nav__link">
    Publishing skaha containers
  </a>
  
    <nav class="md-nav" aria-label="Publishing skaha containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-a-harbor-account" class="md-nav__link">
    Step 1: Create a harbor account
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-docker-login-to-harbor" class="md-nav__link">
    Step 2: Docker login to harbor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-push-your-image-to-your-project" class="md-nav__link">
    Step 3: Push your image to your project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-label-your-image-type" class="md-nav__link">
    Step 4: Label your image type
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#science-platform-actions" class="md-nav__link">
    Science Platform Actions
  </a>
  
    <nav class="md-nav" aria-label="Science Platform Actions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listing-images-on-canfar" class="md-nav__link">
    Listing images on CANFAR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-resource-contexts" class="md-nav__link">
    Listing resource contexts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#launching-containers" class="md-nav__link">
    Launching containers
  </a>
  
    <nav class="md-nav" aria-label="Launching containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-containers" class="md-nav__link">
    Session containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-containers" class="md-nav__link">
    Software containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legacy-desktop-application-containers" class="md-nav__link">
    Legacy desktop application containers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../permissions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Permissions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../science-containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CANFAR Containers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../headless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Headless
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../science-platform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infrastructure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../science-portal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Portal
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorials and Help
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials and Help
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    General Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            General Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/General_tools/File_transfers" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Transfers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/General_tools/Using_webstorage" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Web Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/General_tools/Using_vostools" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using vostools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/General_tools/Using_sshfs" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using sshfs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/General_tools/Group_management" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Group Management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/Notebook/transfer_file" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfering to Notebooks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tips and Tricks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Tips and Tricks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/TipsTricks/Using_clipboard" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using the desktop clipboard
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/TipsTricks/Increase_font" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Increasing desktop font
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/TipsTricks/Direct_url" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    URL upload/download
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    ALMA Tutorials (Desktop Sessions)
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            ALMA Tutorials (Desktop Sessions)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/ALMA_Desktop/start_casa" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starting CASA
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/ALMA_Desktop/archive_download" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Downloading from the ALMA archive (browser)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/ALMA_Desktop/archive_script_download" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Downloading from the ALMA archive (script)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../../general/ALMA_Desktop/typical_reduction" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Example of reducing image data
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    FAQ
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    Introduction
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#building-canfar-science-platform-containers" class="md-nav__link">
    Building CANFAR Science Platform Containers
  </a>
  
    <nav class="md-nav" aria-label="Building CANFAR Science Platform Containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#minimum-requirements" class="md-nav__link">
    Minimum requirements
  </a>
  
    <nav class="md-nav" aria-label="Minimum requirements">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sssd-and-acl" class="md-nav__link">
    SSSD and ACL
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#additional-requirements-for-legacy-desktop-application-containers" class="md-nav__link">
    Additional requirements for legacy desktop application containers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initialization-and-startup" class="md-nav__link">
    Initialization and Startup
  </a>
  
    <nav class="md-nav" aria-label="Initialization and Startup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-container-process-owners" class="md-nav__link">
    Running container process owners
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-container-initialization" class="md-nav__link">
    Session container initialization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributed-session-containers" class="md-nav__link">
    Contributed session containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-container-initialization" class="md-nav__link">
    Software container initialization
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#publishing-skaha-containers" class="md-nav__link">
    Publishing skaha containers
  </a>
  
    <nav class="md-nav" aria-label="Publishing skaha containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-create-a-harbor-account" class="md-nav__link">
    Step 1: Create a harbor account
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-docker-login-to-harbor" class="md-nav__link">
    Step 2: Docker login to harbor
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-push-your-image-to-your-project" class="md-nav__link">
    Step 3: Push your image to your project
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-label-your-image-type" class="md-nav__link">
    Step 4: Label your image type
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#science-platform-actions" class="md-nav__link">
    Science Platform Actions
  </a>
  
    <nav class="md-nav" aria-label="Science Platform Actions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#listing-images-on-canfar" class="md-nav__link">
    Listing images on CANFAR
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#listing-resource-contexts" class="md-nav__link">
    Listing resource contexts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#launching-containers" class="md-nav__link">
    Launching containers
  </a>
  
    <nav class="md-nav" aria-label="Launching containers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#session-containers" class="md-nav__link">
    Session containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#software-containers" class="md-nav__link">
    Software containers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legacy-desktop-application-containers" class="md-nav__link">
    Legacy desktop application containers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing" class="md-nav__link">
    Testing
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/opencadc/science-containers/blob/main/docs/complete/publishing.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14m-2.3 6.35c.22-.21.22-.56 0-.77L15.42 7.3a.532.532 0 0 0-.77 0l-1 1 2.05 2.05 1-1M7 14.94V17h2.06l6.06-6.06-2.06-2.06L7 14.94Z"/></svg>
    </a>
  
  


<h1 id="canfar-science-platform-containers">CANFAR Science Platform Containers<a class="headerlink" href="#canfar-science-platform-containers" title="Permanent link">&para;</a></h1>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h2>
<p>The CANFAR Science Platform supports various types of containers: <code>session</code>, <code>software</code>,  and <code>legacy desktop application</code></p>
<ul>
<li><code>Session</code> are containers launched as native browser interactive applications (i.e. HTML5/Websocket).</li>
<li><code>Software</code> are containers launched with any kind of executable, installed with custom software stack. </li>
<li><code>Legacy desktop application</code> are containers launched and viewed specifically through a desktop <code>session</code>.  </li>
</ul>
<h2 id="building-canfar-science-platform-containers">Building CANFAR Science Platform Containers<a class="headerlink" href="#building-canfar-science-platform-containers" title="Permanent link">&para;</a></h2>
<h3 id="minimum-requirements">Minimum requirements<a class="headerlink" href="#minimum-requirements" title="Permanent link">&para;</a></h3>
<ul>
<li>Containers must be based on a standard Linux x86_84 distribution.</li>
<li>Containers must contain an SSSD client and have ACL capabilities if one want to interact with the <code>arc</code> storage</li>
</ul>
<h4 id="sssd-and-acl">SSSD and ACL<a class="headerlink" href="#sssd-and-acl" title="Permanent link">&para;</a></h4>
<p>For linux group id (<code>gid</code>) names to be resolved, the container must have an SSSD client and ACL tools installed, and must provide an <code>nsswitch.conf</code> file as described below.  If any of these are missing, only group IDs will be displayed (when <code>id</code> is typed for example), but file system authorization will continue to work as expected.
The packages to install on a Debian-based Linux distribution are <code>sssd-client</code> and  <code>acl</code>.</p>
<p>The file <code>/etc/nsswitch.conf</code> must include the <code>sss</code> module in the <code>passwd</code>, <code>shadow</code>, and <code>group</code> entries.  For example:</p>
<div class="highlight"><pre><span></span><code>passwd:     sss files
shadow:     files sss
group:      sss files
</code></pre></div>
<h3 id="additional-requirements-for-legacy-desktop-application-containers">Additional requirements for legacy desktop application containers<a class="headerlink" href="#additional-requirements-for-legacy-desktop-application-containers" title="Permanent link">&para;</a></h3>
<p>Examples of legacy desktop software containers are astronomy GUIs such as CASA, Topcat, Aladin, and customized containers such as Gemini processing containers which require desktop interaction. 
Some of the recipes (Dockerfiles) for building these containers can be found in the <a href="desktop">desktop directory</a>.  They can also be managed and hosted elsewhere. However, wherever the source is hosted, containers must meet a minimal set of requirements and expectations for execution in skaha.
Also the default executuable is <code>xterm</code>, so ensure it is installed.</p>
<p>Note: the desktop session is also sometimes known as the ARCADE software environment.</p>
<h2 id="initialization-and-startup">Initialization and Startup<a class="headerlink" href="#initialization-and-startup" title="Permanent link">&para;</a></h2>
<h4 id="running-container-process-owners">Running container process owners<a class="headerlink" href="#running-container-process-owners" title="Permanent link">&para;</a></h4>
<p>Containers in the CANFAR Science Platform are always executed as the <em>CADC User</em> and never as root. Operations that require root must be done at the build phase of the image.  If runtime root access is required, it can possibly be done by giving sudo access to specific actions.</p>
<h4 id="session-container-initialization">Session container initialization<a class="headerlink" href="#session-container-initialization" title="Permanent link">&para;</a></h4>
<p>Initialization for session containers is based on the session container <em>type</em>.  There are currently four types with different startup procedures:
1. <code>notebook</code>: it requires a <code>jupyter lab</code> executable
1. <code>carta</code>: initialization and startup is done through a customized script
1. <code>desktop-app</code>: desktop session startup is managed by the skaha infrastructure.
1. <code>contributed</code>: it will follow a customized startup script</p>
<p>There may be multiple versions of the same type of session container, but the startup procedure for these must remain the same for them to be of the same type.</p>
<h4 id="contributed-session-containers">Contributed session containers<a class="headerlink" href="#contributed-session-containers" title="Permanent link">&para;</a></h4>
<p>Contributed sessions are for custom-build, web-browser applications that are not officially created and maintained by CANFAR.
The rules of building a container of type "contributed" on the CANFAR Science Platform are:
1. Incoming trafic will be over http (which may include websocket trafic) on port 5000
1. From the point of view of the container, requests will be received at the root path (/), but URLs in the browser will look like https:///, where <host> and <path> are subject to change. This path will initially be <a href="https://ws-uv.canfar.net/sessions/contrib/">https://ws-uv.canfar.net/sessions/contrib/</a><sessionid>
1. The instance will be started by a script in the image that must be available at /skaha/startup.sh and will be passed 1 parameter: the sessionid.</p>
<h4 id="software-container-initialization">Software container initialization<a class="headerlink" href="#software-container-initialization" title="Permanent link">&para;</a></h4>
<p>The <code>CMD</code> and <code>EXECUTABLE</code> directives in a CANFAR container <code>Dockerfile</code> will be ignored on startup.  Instead, bash within an xterm will run. <code>CMD</code> and <code>EXECUTABLE</code> are still useful for testing containers outside of CANFAR.</p>
<p>If the container needs to do any runtime initialization, that can be done in a script named <code>init.sh</code> in the <code>/skaha</code> root directory.  This script <strong>must not block</strong> and needs to return control to the calling process.</p>
<p>If <code>/skaha/init.sh</code> is provided, a sensible directive for testing the container via docker is <code>CMD ["/skaha/init.sh"]</code></p>
<p>Another option is for containers to make available a file named <code>/skaha/startup.sh</code>.  If it exists, it will be called with a single parameter, which is the command <code>startup.sh</code> must run in order to execute on the platform.  So, the end of <code>startup.sh</code> should do: <code>exec "$@"</code> to execute the incoming parameter.  Containers should use startup.sh when environment must be made available to the context of the application.</p>
<p><a name="publishing"></a></p>
<h2 id="publishing-skaha-containers">Publishing skaha containers<a class="headerlink" href="#publishing-skaha-containers" title="Permanent link">&para;</a></h2>
<h3 id="step-1-create-a-harbor-account">Step 1: Create a harbor account<a class="headerlink" href="#step-1-create-a-harbor-account" title="Permanent link">&para;</a></h3>
<p>The CANFAR Science Platform hosts a private container registry. It is an instance of the <a href="https://goharbor.io/">Harbor</a> open source project as a container registry. Session and software containers launched can be launched from this registry.</p>
<p>If you have logged into harbor before then step 1 can be skipped.</p>
<ol>
<li>Go to <a href="https://images.canfar.net">https://images.canfar.net</a></li>
<li>Press the <code>Login with OIDC Provider</code> button.</li>
<li>Enter your CADC username and password.</li>
<li>When prompter for a harbor userid, use your CADC username.</li>
</ol>
<p>After these steps you now have a harbor account and can see the project containers through its interface. If you wish to publish to any of the projects, contact the project admistrator (or contact <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#99;&#97;&#110;&#102;&#97;&#114;&#46;&#110;&#101;&#116;">&#115;&#117;&#112;&#112;&#111;&#114;&#116;&#64;&#99;&#97;&#110;&#102;&#97;&#114;&#46;&#110;&#101;&#116;</a>) and ask for 'Development' access to the project.</p>
<h3 id="step-2-docker-login-to-harbor">Step 2: Docker login to harbor<a class="headerlink" href="#step-2-docker-login-to-harbor" title="Permanent link">&para;</a></h3>
<ol>
<li>From the harbor portal, go to the top right, click on your username, then go to 'User Profile'.</li>
<li>Set your CLI secret -- this is the password to use for <code>docker login</code> commands.  You can copy the existing, generated secret, or 'upload' (enter) your own.</li>
<li>From the computer on which you have built the docker image you wish to publish, do a docker login:</li>
</ol>
<p><code>docker login images.canfar.net</code></p>
<p>Your user is your CADC username, and your password the value of the CLI Secret mentioned above.</p>
<h3 id="step-3-push-your-image-to-your-project">Step 3: Push your image to your project<a class="headerlink" href="#step-3-push-your-image-to-your-project" title="Permanent link">&para;</a></h3>
<ol>
<li>On the same computer, find the <code>IMAGE ID</code> of the image you'd like to push with the command</li>
</ol>
<p><code>docker images</code></p>
<ol>
<li>Tag the image for harbor:</li>
</ol>
<p><code>docker tag &lt;IMAGE ID&gt; images.canfar.net/&lt;PROJECT&gt;/&lt;MY IMAGE NAME&gt;:&lt;IMAGE VERSION&gt;</code> </p>
<p>where:
   * <code>&lt;PROJECT&gt;</code> is the project to which you've been granted Developer access.
   * <code>&lt;MY IMAGE NAME&gt;</code> is the name of the image you are publishing.
   * <code>&lt;IMAGE VERSION&gt;</code> is the version of the image.</p>
<ol>
<li>Push the image to harbor, with:</li>
</ol>
<p><code>docker push images.canfar.net/&lt;PROJECT&gt;/&lt;MY IMAGE NAME&gt;:&lt;IMAGE VERSION&gt;</code></p>
<h3 id="step-4-label-your-image-type">Step 4: Label your image type<a class="headerlink" href="#step-4-label-your-image-type" title="Permanent link">&para;</a></h3>
<ol>
<li>Go back to <a href="https://images.canfar.net">https://images.canfar.net</a></li>
<li>Click on your project, then on your newly pushed image (also called a repository in harbor).</li>
<li>Select the 'artifact' with the correct version (tag).</li>
<li>Under the 'Actions' drop-down, apply the approripate label to the artifact.</li>
</ol>
<h2 id="science-platform-actions">Science Platform Actions<a class="headerlink" href="#science-platform-actions" title="Permanent link">&para;</a></h2>
<p>A number of the steps below can be done using the CANFAR Science Platform Portal at <a href="https://www.canfar.net">https://www.canfar.net</a></p>
<h3 id="listing-images-on-canfar">Listing images on CANFAR<a class="headerlink" href="#listing-images-on-canfar" title="Permanent link">&para;</a></h3>
<p>Once publishing and labeling has been completed, the image will be visible.  It can then be seen on the Science Platform Portal, or with the folowing command:</p>
<p><code>curl -E &lt;cadcproxy.pem&gt; https://ws-uv.canfar.net/skaha/v0/image</code></p>
<h3 id="listing-resource-contexts">Listing resource contexts<a class="headerlink" href="#listing-resource-contexts" title="Permanent link">&para;</a></h3>
<p>The available cores and RAM in skaha can be seen from the Science Platform, or viewed with:</p>
<p><code>curl -E &lt;cadcproxy.pem&gt; https://ws-uv.canfar.net/skaha/v0/context</code></p>
<p><a name="launching"></a></p>
<h2 id="launching-containers">Launching containers<a class="headerlink" href="#launching-containers" title="Permanent link">&para;</a></h2>
<h3 id="session-containers">Session containers<a class="headerlink" href="#session-containers" title="Permanent link">&para;</a></h3>
<ol>
<li>Use the Science Platform Portal or this curl command to launch your newly published image:</li>
</ol>
<p><code>curl -E &lt;cadcproxy.pem&gt; https://ws-uv.canfar.net/skaha/v0/session -d "name=&lt;arbitrary-name&gt;" -d "image=images.canfar.net/&lt;PROJECT&gt;/&lt;MY IMAGE NAME&gt;:&lt;IMAGE VERSION&gt;"</code></p>
<p>If non-default values for cores and/or ram is preferred, the parameters <code>-d cores=&lt;cores&gt;</code> and <code>-d ram=&lt;ram&gt;</code> can be added to the session launching command above.</p>
<ol>
<li>Use the Science Platform Portal or this curl command to find the URL to your session:</li>
</ol>
<p><code>curl -E &lt;cadcproxy.pem&gt; https://ws-uv.canfar.net/skaha/v0/session</code></p>
<p>If this is the first time this image has been launched in may take a few minutes for the cloud do retrieve the image from harbor and send it to the selected node.</p>
<h3 id="software-containers">Software containers<a class="headerlink" href="#software-containers" title="Permanent link">&para;</a></h3>
<p>It should just run as is. See also <a href="HEADLESS.md">headless containers</a>.</p>
<h3 id="legacy-desktop-application-containers">Legacy desktop application containers<a class="headerlink" href="#legacy-desktop-application-containers" title="Permanent link">&para;</a></h3>
<p>Once a legacy desktop software container has been pushed to harbor, it must be labelled with <code>desktop-app</code>.</p>
<p>To then make it appear in the <code>Applications-&gt;Astro Software</code> menu on the desktop a new desktop session must be started.</p>
<p>The desktop menu items in <code>Applications-&gt;Astro Software</code> are organized by harbor project.  A sub-folder is created for each project.  Then, each version of the artifacts (images) within that project will be displayed in the project sub-folder.  For example, the desktop-app image identified by URI:</p>
<p><code>images.canfar.net/skaha/terminal:1.0</code></p>
<p>will be placed in the desktop menu like so:</p>
<p><code>Applications -&gt; Astro Software -&gt; skaha -&gt; terminal:1.0</code></p>
<p><a name="testing"></a></p>
<h2 id="testing">Testing<a class="headerlink" href="#testing" title="Permanent link">&para;</a></h2>
<p>Before publishing a new or modified image, testing should be done to ensure it works as expected.</p>
<p>For session containers, nearly all testing can be done by using <code>docker</code> to run the image.  A port should be exposed so you can connect your browser to the locally running session.</p>
<p>For legacy desktop application containers, docker will not be able to provide a graphical display of CASA windows, so most testing must be done in a skaha-desktop instance running in the cloud.</p>
<p>The only requirement for a container is to ensure the web application to be launched with a <code>/skaha/startup.sh</code> script in the container, and the web application running on port 5000.</p>
<p><img alt="CANFAR" height="200" src="https://www.canfar.net/css/images/logo.png" /></p>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">January 11, 2024</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 CANFAR
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["tabs", "instant", "content.action.edit", "offline", "navigation.sections"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.aecac24b.min.js"></script>
      
    
  </body>
</html>